\documentclass[11pt,a4paper]{article}

% ---- Idioma y tipografía
\usepackage[spanish, es-noquoting, es-noshorthands]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc} % eliminar si usas XeLaTeX/LuaLaTeX
\usepackage{lmodern}
\usepackage{microtype}

% ---- Márgenes y diseño
\usepackage[a4paper,margin=2.5cm]{geometry}
\usepackage{parskip}

% ---- Enlaces
\usepackage[hidelinks]{hyperref}
\usepackage{bookmark}

% ---- Cabeceras y pies
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0.4pt}
\lhead{\textsc{\asignatura}}
\chead{\textbf{\tema}}
\rhead{\clase\;|\; \fecha}
\cfoot{\thepage}

% ---- Listas y símbolos
\usepackage{enumitem}
\setlist{itemsep=0.3em, topsep=0.5em}

% ---- Iconos y color
\usepackage{fontawesome5}
\usepackage{xcolor}
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable,skins}

% ---- Figuras
\usepackage{graphicx}
\usepackage{caption}

% ---- Colores propios
\definecolor{uniPrimary}{HTML}{0A7AC3}
\definecolor{uniSoft}{HTML}{E9F4FB}
\definecolor{uniAccent}{HTML}{F5B700}
\definecolor{uniOK}{HTML}{2E7D32}
\definecolor{uniWarn}{HTML}{C62828}

% ---- Metadatos reutilizables
\newcommand{\asignatura}{Seguridad de Sistemas Informáticos}
\newcommand{\tema}{Tema 1 — Introducción}
\newcommand{\clase}{Clase 1}
\newcommand{\fecha}{\today}

% ---- Estética de secciones
\usepackage{titlesec}
\titleformat{\section}{\Large\bfseries\color{uniPrimary}}{\thesection}{0.6em}{}
\titleformat{\subsection}{\large\bfseries}{\thesubsection}{0.5em}{}
\titleformat{\subsubsection}{\bfseries}{\thesubsubsection}{0.5em}{}

% ---- Cajas reutilizables
\tcbset{
    commonstyle/.style={
        enhanced, breakable,
        left=8pt,right=8pt,top=8pt,bottom=8pt,
        boxrule=0.8pt,
        fonttitle=\bfseries
    }
}

\newtcolorbox{ObjetivosBox}[1][]{
    commonstyle,
    title={\faBullseye\; Índice},
    colback=uniSoft, colframe=uniPrimary,#1
}

\newtcolorbox{DefBox}[1][]{
    commonstyle,
    title={\faBook\; Definición},
    colback=white, colframe=uniAccent,#1
}

\newtcolorbox{NotaBox}[1][]{
    commonstyle,
    title={\faStickyNote\; Nota},
    colback=white, colframe=uniPrimary,#1
}

\newtcolorbox{RecordatorioBox}[1][]{
    commonstyle,
    title={\faBell\; Recordatorio},
    colback=uniAccent!15, colframe=uniAccent,#1
}

\newtcolorbox{ChecklistBox}[1][]{
    commonstyle,
    title={\faTasks\; Tareas / Checklist},
    colback=white, colframe=uniPrimary,#1
}

\newtcolorbox{ResumenBox}[1][]{
    commonstyle,
    title={\faHighlighter\; Resumen rápido (5 líneas)},
    colback=uniSoft, colframe=uniPrimary,#1
}

\newtcolorbox{VocabBox}[1][]{
    commonstyle,
    title={\faLanguage\; Vocabulario clave},
    colback=white, colframe=uniPrimary,#1
}

% =========================================================
\begin{document}

\begin{center}
    {\LARGE \textbf{\asignatura}}\\[0.3cm]
    {\large \tema}\\[0.2cm]
    \clase\; -- \fecha
\end{center}
\hrule
\vspace{1em}

\section{Algoritmos de cifrado}
\subsection{Autenticación de los mensajes}

\begin{DefBox}
La \textbf{autenticación de mensajes} no siempre requiere confidencialidad.
A veces interesa garantizar la autenticidad sin necesidad de ocultar el contenido, como ocurre en documentos de escritura pública.
\end{DefBox}

\begin{NotaBox}
El cifrado por sí solo \textbf{no proporciona autenticación}.
Es posible combinar cifrado y autenticación (por ejemplo, con el algoritmo OCB).
\end{NotaBox}

Normalmente, la autenticación se implementa de forma independiente al cifrado, mediante funciones hash.

\subsubsection*{Autenticación de mensajes con MAC}
\begin{center}
    \includegraphics[width=0.6\textwidth]{resources/MAC.png}
    \captionof{figure}{Esquema de autenticación de mensajes con MAC}
\end{center}

\subsubsection*{Autenticación de mensajes con funciones hash unidireccionales}
\begin{center}
    \includegraphics[width=0.6\textwidth]{resources/Hash_Unidirectional.png}
    \captionof{figure}{Esquema de autenticación con funciones hash unidireccionales}
\end{center}

El primer caso es cifrado simétrico, el segundo es cifrado asimétrico. El tercero es usando valor secreto.

\begin{RecordatorioBox}
En este caso no se habla de una “clave” como tal, sino de un \textbf{valor secreto}.
Sólo se denomina clave cuando tanto emisor como receptor deben conocerla.
\end{RecordatorioBox}

\subsection{Criterios de utilidad de una función hash}

Una función hash criptográfica debe cumplir las siguientes propiedades:

\begin{itemize}
    \item \textbf{Entrada arbitraria:} se puede aplicar sobre un conjunto de datos de cualquier tamaño.
    \item \textbf{Determinismo:} para una misma entrada $x$, siempre devuelve el mismo valor $H(x)$.
    \item \textbf{Eficiencia computacional:} $H(x)$ debe calcularse de manera rápida y con un coste razonable.
    \item \textbf{Resistencia a colisiones:} debe ser computacionalmente inviable encontrar dos entradas distintas $x$ y $y$ tales que $H(x)=H(y)$.
    \item \textbf{Irreversibilidad:} dado un valor $h$, debe ser difícil obtener la entrada original $x$ tal que $H(x)=h$.
\end{itemize}

\subsection{Seguridad de las funciones hash}

Existen dos enfoques principales para atacar la seguridad de una función hash:

\begin{itemize}
    \item \textbf{Criptoanálisis:} se centra en explotar debilidades matemáticas o estructurales del algoritmo.
    \item \textbf{Fuerza bruta:} consiste en probar todas las combinaciones posibles. La viabilidad depende de la longitud del código hash generado por el algoritmo.
\end{itemize}

Actualmente, los algoritmos de la familia \textbf{SHA} son los más utilizados en aplicaciones prácticas.

\subsubsection*{Aplicaciones de una función hash segura}

\begin{itemize}
    \item \textbf{Almacenamiento de contraseñas:} en lugar de guardar la contraseña en texto plano, los sistemas almacenan únicamente su valor hash.
    \item \textbf{Integridad de datos:} permite verificar si un archivo o mensaje ha sido modificado. También se aplica en la detección de intrusiones en sistemas.
\end{itemize}

\subsection{Secure Hash Algorithm (SHA)}

El \textbf{Secure Hash Algorithm (SHA)} fue desarrollado originalmente por el \textbf{NIST (National Institute of Standards and Technology)}.
Existen varias versiones de SHA, cada una con distintos parámetros y niveles de seguridad:

\begin{table}[h!]
\centering
\renewcommand{\arraystretch}{1.2}
\setlength{\tabcolsep}{8pt}
\begin{tabular}{|l|c|c|c|c|c|c|c|}
\hline
 & \textbf{SHA-1} & \textbf{SHA-224} & \textbf{SHA-256} & \textbf{SHA-384} & \textbf{SHA-512} & \textbf{SHA-512/224} & \textbf{SHA-512/256} \\ \hline
\textbf{Message size} & $< 2^{64}$ & $< 2^{64}$ & $< 2^{64}$ & $< 2^{128}$ & $< 2^{128}$ & $< 2^{128}$ & $< 2^{128}$ \\ \hline
\textbf{Word size} & 32 & 32 & 32 & 64 & 64 & 64 & 64 \\ \hline
\textbf{Block size} & 512 & 512 & 512 & 1024 & 1024 & 1024 & 1024 \\ \hline
\textbf{Message digest size} & 160 & 224 & 256 & 384 & 512 & 224 & 256 \\ \hline
\textbf{Number of steps} & 80 & 64 & 64 & 80 & 80 & 80 & 80 \\ \hline
\textbf{Security} & 80 & 112 & 128 & 192 & 256 & 112 & 128 \\ \hline
\end{tabular}
\caption{Comparativa de las variantes de SHA}
\end{table}


\begin{NotaBox}
El algoritmo \textbf{SHA-1} ya no se considera seguro, debido a que es vulnerable a ataques de colisión, como el \textit{ataque de cumpleaños}.
\end{NotaBox}

\begin{DefBox}
\textbf{SHA-3} representa un cambio importante en la estructura interna, ya que no se basa en el mismo diseño de SHA-1 y SHA-2.
Permite longitudes de valores hash de 224, 256, 384 y 512 bits.
Una característica clave es que puede aplicarse de forma incremental sobre bloques de datos, sin necesidad de disponer del mensaje completo desde el inicio.
\end{DefBox}

\subsection{Hashed Message Authentication Code (HMAC)}

El \textbf{HMAC} se utiliza en protocolos de seguridad como \textbf{TLS (Transport Layer Security)} o \textbf{SET (Secure Electronic Transaction)}.
Es el estándar de autenticación en muchos protocolos seguros de Internet.

\subsection*{Objetivos de diseño}
\begin{itemize}
    \item Reutilizar funciones hash criptográficas existentes.
    \item Permitir el uso de claves de longitud variable.
    \item Ofrecer un nivel de seguridad equivalente al de la función hash subyacente.
\end{itemize}

\begin{DefBox}
La seguridad de HMAC depende tanto de la \textbf{robustez criptográfica} de la función hash utilizada como de la \textbf{longitud y calidad de la clave secreta}.
Con las funciones y longitudes de clave recomendadas en la actualidad, HMAC se considera seguro.
\end{DefBox}

\subsection{OCB (Offset Codebook Mode)}

El modo \textbf{OCB} es un esquema avanzado que combina en una sola operación dos objetivos fundamentales:
\begin{itemize}
    \item \textbf{Cifrado de la información.}
    \item \textbf{Autenticación del mensaje.}
\end{itemize}

\begin{NotaBox}
Una ventaja de OCB es que el usuario no necesita conocer en detalle su funcionamiento interno para aprovechar sus beneficios de seguridad y eficiencia.
\end{NotaBox}

\subsection{Distribución de claves}

La \textbf{gestión y distribución de claves} es uno de los principales retos en criptografía, ya que debe garantizarse que las claves se compartan de forma segura entre las partes legítimas sin ser interceptadas por terceros.

Algunas estrategias de distribución son:

\begin{itemize}
    \item El emisor (\textbf{A}) entrega físicamente la clave al receptor (\textbf{B}).
    \item Un tercero de confianza selecciona la clave y la distribuye físicamente a ambas partes.
    \item Si \textbf{A} y \textbf{B} ya comparten una clave previa, pueden generar una nueva y enviarla cifrada con la clave antigua.
    \item Si ambos tienen una conexión segura con un tercero (\textbf{C}), este puede generar una clave y distribuirla cifrada a las dos partes.
\end{itemize}

\begin{RecordatorioBox}
El diseño de sistemas criptográficos robustos no solo depende de algoritmos fuertes, sino también de una correcta \textbf{gestión del ciclo de vida de las claves}.
\end{RecordatorioBox}

\end{document}
